{% extends 'base.html' %}
{% load static %}

{% block title %} ê²Œì„ ìƒì„¸ {% endblock %}

{% block content %}
<div class="game-detail-container detail-content-font">
    <h2>{{game.attacker.username}} VS {{game.defender.username}}</h2>

    {% if game.status == 'ONGOING' %}
        <p class="result-text">{{result_text}}</p>
        <p>ë‚˜: {{game.attacker_card}}ğŸ˜Š</p>
    {% elif game.status == 'PENDING' %}
        {% if request.user != game.attacker %}
            <p class="result-text">{{result_text}}</p>
            <p>ê³µê²©ì„ ë°›ì•˜ìŠµë‹ˆë‹¤.<br>ëŒ€ì‘í•˜ë ¤ë©´ ë°˜ê²©í•˜ê¸°ë¥¼ ì„ íƒí•˜ì„¸ìš”.ğŸ¥Š</p>
            <a class="button-counter_attack" style="background-color: rgb(235, 213, 14);" href="{% url 'game:counter_attack' game.id %}">ë°˜ê²©í•˜ê¸°</a>
        {% endif %}
        {% if request.user != game.defender %}
            <p class="result-text">{{result_text}}</p>
            <p>ë‚˜: {{game.attacker_card}}ğŸ˜Š<p>
                <a class="button-cancel" style="background-color: lightgrey;" href="{% url 'game:cancel_game' game.id %}">ì·¨ì†Œí•˜ê¸°</a>
        {% endif %}
    {% elif game.status == 'FINISHED' %}
        <p class="result-text">{{result_text}}</p>
        <p>{{game.attacker.username}}: {{game.attacker_card}}</p>
        <p class="card-num">{{game.defender.username}}: {{game.defender_card}}</p>
        <p>
            {% if game.result == 'DRAW' %}
                ê²°ê³¼:<span class="game-result draw">ë¬´ìŠ¹ë¶€ğŸ˜…</span>
            {% elif request.user == game.attacker and game.result == 'ATTACKER_WIN' or request.user == game.defender and game.result == 'DEFENDER_WIN' %}
                ê²°ê³¼:<span class="game-result win">ìŠ¹ë¦¬ğŸ¥³ğŸ‰</span>
            {% else %}
                ê²°ê³¼:<span class="game-result lose">íŒ¨ë°°ğŸ¥¹ğŸ™</span>
            {% endif %}
        </p>
        <p>ì ìˆ˜: 
            {% if request.user == game.attacker %}
                {{ game.attacker_score }}
            {% elif request.user == game.defender %}
                {{ game.defender_score }}
            {% endif %}
        </p>
    {% elif game.status == 'CANCELLED' %}
        <p class="result-text">ì¢…ë£Œëœ ê²Œì„!âœ–ï¸</p>
        <a class="button" href="{% url 'game:game_history' %}">ì „ì ëª©ë¡</a>
    {% endif %}

    {% if game.status == 'PENDING' and request.user == game.defender %}
        <a class="button" href="{% url 'game:game_history' %}">ì „ì ëª©ë¡</a>
    {% else %}
        {% for button in buttons %}
            {% if button == 'ê²Œì„ì·¨ì†Œ' %}
                <form action="{% url 'game:cancel_game' game.id %}" method="post" style="display:inline;">
                    {% csrf_token %}
                    <button class="button" type="submit">{{ button }}</button>
                </form>
            {% elif button == 'ëŒ€ì‘í•˜ê¸°' %}
                <a class="button" href="{% url 'game:counter_attack' game.id %}">{{ button }}</a>
            {% elif button == 'ì „ì ëª©ë¡' %}
                <a class="button" href="{% url 'game:game_history' %}">{{ button }}</a>
            {% endif %}
        {% endfor %}
    {% endif %}
</div>
{% endblock %}

