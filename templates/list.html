{% extends 'base.html' %}
{% load static %}

{% block title %}Game History{% endblock %}

{% block content %}
<div class="game-history">
    <h2 class="game-history__title">ğŸƒ {{ user.username }}'s History ğŸƒ <a href="/game/attack/" style="text-decoration: none; color: white;">âš”ï¸ Go to Attack âš”ï¸</a></h2>

    <h3 class="game-history__subtitle">âš”ï¸ My Attack âš”ï¸</h3>

    <ul class="game-list">
    {% for game in attacks %}
        <li class="game-item">
            <div class="game-item__info">
                <span class="game-item__opponent">vs {{ game.defender.username }}</span> - 
                <span class="game-item__status">
                {% if game.status == 'PENDING' %}
                    ì§„í–‰ì¤‘... 
                    <form class="game-item__cancel-form" action="{% url 'game:cancel_game' game.id %}" method="post">
                        {% csrf_token %}
                        <button class="btn btn--cancel" type="submit">ì·¨ì†Œí•˜ê¸°</button>
                    </form>
                {% elif game.status == 'ONGOING' %}
                    ê²Œì„ ì§„í–‰ ì¤‘
                {% elif game.status == 'FINISHED' %}
                    <span class="game-item__result {% if game.result == 'ATTACKER_WIN' %}game-item__result--win{% elif game.result == 'DEFENDER_WIN' %}game-item__result--lose{% else %}game-item__result--draw{% endif %}">
                    {% if game.result == 'ATTACKER_WIN' %}
                        ìŠ¹ë¦¬
                    {% elif game.result == 'DEFENDER_WIN' %}
                        íŒ¨ë°°
                    {% else %}
                        ë¬´ìŠ¹ë¶€
                    {% endif %}
                    </span>
                {% elif game.status == 'CANCELLED' %}
                    ì·¨ì†Œë¨
                {% endif %}
                </span>
            </div>
            <a class="btn btn--detail" href="{% url 'game:game_detail' game.id %}">More</a>
        </li>
    {% endfor %}
    </ul>

    <h3 class="game-history__subtitle">ğŸ›¡ï¸ My Defence ğŸ›¡ï¸</h3>
    <ul class="game-list">
    {% for game in defenses %}
        <li class="game-item">
            <div class="game-item__info">
                <span class="game-item__opponent">vs {{ game.attacker.username }}</span> - 
                <span class="game-item__status">
                {% if game.status == 'PENDING' %}
                    ê³µê²©ë°›ëŠ” ì¤‘ì…ë‹ˆë‹¤! <a class="btn btn--counter" href="{% url 'game:counter_attack' game.id %}">ë°˜ê²©í•˜ê¸°</a>
                {% elif game.status == 'ONGOING' %}
                    ê²Œì„ ì§„í–‰ ì¤‘
                {% elif game.status == 'FINISHED' %}
                    <span class="game-item__result {% if game.result == 'DEFENDER_WIN' %}game-item__result--win{% elif game.result == 'ATTACKER_WIN' %}game-item__result--lose{% else %}game-item__result--draw{% endif %}">
                    {% if game.result == 'DEFENDER_WIN' %}
                        ìŠ¹ë¦¬
                    {% elif game.result == 'ATTACKER_WIN' %}
                        íŒ¨ë°°
                    {% else %}
                        ë¬´ìŠ¹ë¶€
                    {% endif %}
                    </span>
                {% elif game.status == 'CANCELLED' %}
                    ì·¨ì†Œë¨
                {% endif %}
                </span>
            </div>
            <a class="btn btn--detail" href="{% url 'game:game_detail' game.id %}">More</a>
        </li>
    {% endfor %}
    </ul>
</div>
{% endblock %}